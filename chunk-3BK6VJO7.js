import{a as le}from"./chunk-75TYTFGY.js";import{a as ce}from"./chunk-MAZ6WOLX.js";import{a as re}from"./chunk-SGVJUPTJ.js";import{a as ae}from"./chunk-5BGZ6L4W.js";import{a as oe}from"./chunk-7G6M72YL.js";import{$ as s,A,F as c,Ha as I,K as O,L as $,Ma as Z,O as i,R as j,Z as Y,Za as ee,_ as d,_a as te,ca as q,da as K,db as ne,ea as w,fa as a,ga as r,ha as b,la as V,lb as ie,na as B,pa as m,qa as Q,ra as J,sa as X,v as W,wa as l,x as L,xa as S,y as R,ya as _,z as P,za as z}from"./chunk-TOYJLBVG.js";var pe=["playerContainer"],H=e=>["/movie",e],_e=e=>["/director",e],he=e=>["/decade",e],se=e=>["/watch",e],ve=(e,t)=>t.id;function ue(e,t){e&1&&b(0,"app-loading-spinner")}function xe(e,t){if(e&1&&(a(0,"span",5),l(1),r()),e&2){let n=m(2);i(),_("(",n.movieYear(),")")}}function fe(e,t){if(e&1&&(a(0,"p",6),l(1),r()),e&2){let n=m(2);i(),S(n.movieGenres())}}function Ce(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 \u2605 ",n.movieRating())}}function ye(e,t){if(e&1&&(a(0,"span",8),l(1,"\xB7 "),a(2,"a",28),l(3),r()()),e&2){let n=m(2);i(2),w("routerLink",I(2,_e,n.directorName())),i(),S(n.directorName())}}function be(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.filmAge())}}function we(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.movieLanguage())}}function Se(e,t){e&1&&(a(0,"span",8),l(1,"\xB7 Co-directed"),r())}function Me(e,t){e&1&&(a(0,"span",8),l(1,"\xB7 Silent Era"),r())}function ke(e,t){e&1&&(a(0,"span",8),l(1,"\xB7 Non-English"),r())}function Pe(e,t){e&1&&(a(0,"span",8),l(1,"\xB7 Highly Rated"),r())}function Ee(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.decadeFilmCount()," films from this decade")}}function Ie(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.movieDecadeRank())}}function We(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),z("\xB7 ",n.sameYearCount()," films from ",n.movieYear())}}function Te(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.directorGenreSpan()," genres by director")}}function De(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.genrePeerCount()," films in same genre")}}function Oe(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 #",n.catalogRankByRating()," by rating")}}function Ne(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.directorHighRatedCount()," highly-rated by director")}}function Fe(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.genreLabel())}}function Le(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.movieTitleWordCount(),"-word title")}}function Re(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.decadeStreamableCount()," streamable from this decade")}}function Ae(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.primaryGenreStreamablePct(),"% of genre streamable")}}function Be(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),z("\xB7 ",n.sameLanguageCount()," ",n.movieLanguage()||"English"," films")}}function ze(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.directorCareerSpan(),"-year career")}}function Ge(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.movieGenreCount()," genres")}}function Ue(e,t){e&1&&(a(0,"span",8),l(1,"\xB7 on IMDb"),r())}function Ve(e,t){e&1&&(a(0,"span",8),l(1,"\xB7 Pre-1940"),r())}function He(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.decadeImdbLinkedPct(),"% of decade on IMDb")}}function $e(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.genrePosterCoveragePct(),"% of genre have posters")}}function je(e,t){if(e&1&&(a(0,"span",8),l(1),r()),e&2){let n=m(2);i(),_("\xB7 ",n.directorImdbLinkedPct(),"% of director's films on IMDb")}}function Ye(e,t){if(e&1&&(a(0,"span",8),l(1,"\xB7 "),a(2,"a",28),l(3),r()()),e&2){let n=m(2);i(2),w("routerLink",I(2,he,n.decadeValue())),i(),S(n.decadeLabel())}}function qe(e,t){e&1&&(P(),a(0,"svg",12),b(1,"polyline",29)(2,"polyline",30)(3,"line",31)(4,"line",32),r())}function Ke(e,t){e&1&&(P(),a(0,"svg",12),b(1,"polyline",33)(2,"polyline",34)(3,"line",35)(4,"line",32),r())}function Qe(e,t){if(e&1){let n=V();a(0,"button",36),B("click",function(){L(n);let o=m(2);return R(o.markWatched())}),P(),a(1,"svg",37),b(2,"polyline",38),r(),l(3," Mark as Watched "),r()}}function Je(e,t){if(e&1&&(a(0,"span",40),l(1),r()),e&2){let n=m(3);i(),S(n.watchedAgo())}}function Xe(e,t){if(e&1&&(a(0,"span",17),P(),a(1,"svg",39),b(2,"polyline",38),r(),l(3," Watched "),d(4,Je,2,1,"span",40),r()),e&2){let n=m(2);i(4),s(n.watchedAgo()?4:-1)}}function Ze(e,t){if(e&1&&(a(0,"span",5),l(1),r()),e&2){let n=m(3);i(),_("(",n.directorTotalFilms()," in catalog)")}}function et(e,t){if(e&1&&(a(0,"span",5),l(1),r()),e&2){let n=m(3);i(),_(" \xB7 ",n.directorFilmRank())}}function tt(e,t){if(e&1&&(a(0,"span",5),l(1),r()),e&2){let n=m(3);i(),_(" \xB7 avg \u2605 ",n.directorAvgRating())}}function nt(e,t){if(e&1&&b(0,"img",44),e&2){let n=m().$implicit;w("src",n.posterUrl,O)("alt",n.title)}}function it(e,t){if(e&1&&(a(0,"div",45),l(1),r()),e&2){let n=m().$implicit;i(),S(n.title[0])}}function at(e,t){if(e&1&&(a(0,"a",43),d(1,nt,1,2,"img",44)(2,it,2,1,"div",45),a(3,"span",46),l(4),r(),a(5,"span",47),l(6),r()()),e&2){let n=t.$implicit;w("routerLink",n.isStreamable?I(4,se,n.id):I(6,H,n.id)),i(),s(n.posterUrl?1:2),i(3),S(n.title),i(2),S(n.year)}}function ot(e,t){if(e&1&&(a(0,"div",26)(1,"h3",41),l(2),d(3,Ze,2,1,"span",5),d(4,et,2,1,"span",5),d(5,tt,2,1,"span",5),r(),a(6,"div",42),q(7,at,7,8,"a",43,ve),r()()),e&2){let n=m(2);i(2),_("More from ",n.directorName()),i(),s(n.directorTotalFilms()>2?3:-1),i(),s(n.directorFilmRank()?4:-1),i(),s(n.directorAvgRating()?5:-1),i(2),K(n.directorFilms())}}function rt(e,t){if(e&1&&(a(0,"span",49),l(1),r()),e&2){let n=m(3);i(),S(n.upNextReason())}}function lt(e,t){if(e&1&&b(0,"img",51),e&2){let n=m();w("src",n.posterUrl,O)("alt",n.title)}}function ct(e,t){if(e&1&&(a(0,"span",53),l(1),r()),e&2){let n=m();i(),_("\u2605 ",n.voteAverage.toFixed(1))}}function dt(e,t){if(e&1&&(a(0,"div",27)(1,"span",48),l(2,"Up Next"),r(),d(3,rt,2,1,"span",49),a(4,"a",50),d(5,lt,1,2,"img",51),a(6,"div",52)(7,"strong"),l(8),r(),a(9,"span"),l(10),r(),d(11,ct,2,1,"span",53),r()()()),e&2){let n=t,h=m(2);i(3),s(h.upNextReason()?3:-1),i(),w("routerLink",I(7,se,n.id)),i(),s(n.posterUrl?5:-1),i(3),S(n.title),i(2),z("",n.year," \xB7 ",n.genres.slice(0,2).join(", ")),i(),s(n.voteAverage>0?11:-1)}}function st(e,t){if(e&1){let n=V();a(0,"div",1)(1,"div",3)(2,"a",4),l(3,"\u2190 Back to details"),r(),a(4,"h1"),l(5),d(6,xe,2,1,"span",5),r(),d(7,fe,2,1,"p",6),a(8,"p",7),l(9),d(10,Ce,2,1,"span",8),d(11,ye,4,4,"span",8),d(12,be,2,1,"span",8),d(13,we,2,1,"span",8),d(14,Se,2,0,"span",8),d(15,Me,2,0,"span",8),d(16,ke,2,0,"span",8),d(17,Pe,2,0,"span",8),d(18,Ee,2,1,"span",8),d(19,Ie,2,1,"span",8),d(20,We,2,2,"span",8),d(21,Te,2,1,"span",8),d(22,De,2,1,"span",8),d(23,Oe,2,1,"span",8),d(24,Ne,2,1,"span",8),d(25,Fe,2,1,"span",8),d(26,Le,2,1,"span",8),d(27,Re,2,1,"span",8),d(28,Ae,2,1,"span",8),d(29,Be,2,2,"span",8),d(30,ze,2,1,"span",8),d(31,Ge,2,1,"span",8),d(32,Ue,2,0,"span",8),d(33,Ve,2,0,"span",8),d(34,He,2,1,"span",8),d(35,$e,2,1,"span",8),d(36,je,2,1,"span",8),d(37,Ye,4,4,"span",8),r()(),a(38,"div",9,0),b(40,"iframe",10),a(41,"button",11),B("click",function(){L(n);let o=m();return R(o.toggleFullscreen())}),d(42,qe,5,0,":svg:svg",12)(43,Ke,5,0,":svg:svg",12),r()(),a(44,"div",13)(45,"span",14)(46,"kbd"),l(47,"f"),r(),l(48," fullscreen"),r()(),a(49,"div",15),d(50,Qe,4,0,"button",16)(51,Xe,5,1,"span",17),a(52,"a",18),l(53),r(),a(54,"button",19),B("click",function(){L(n);let o=m();return R(o.shareFilm())}),P(),a(55,"svg",20),b(56,"circle",21)(57,"circle",22)(58,"circle",23)(59,"line",24)(60,"line",25),r(),l(61," Share "),r()(),d(62,ot,9,4,"div",26),d(63,dt,12,9,"div",27),r()}if(e&2){let n,h=t,o=m();i(2),w("routerLink",I(43,H,o.id())),i(3),S(o.movieTitle()),i(),s(o.movieYear()?6:-1),i(),s(o.movieGenres()?7:-1),i(2),_(" Streaming via ",h.label," "),i(),s(o.movieRating()?10:-1),i(),s(o.directorName()?11:-1),i(),s(o.filmAge()?12:-1),i(),s(o.movieLanguage()?13:-1),i(),s(o.isCoDirected()?14:-1),i(),s(o.isSilentEra()?15:-1),i(),s(o.isNonEnglish()?16:-1),i(),s(o.isHighlyRated()?17:-1),i(),s(o.decadeFilmCount()?18:-1),i(),s(o.movieDecadeRank()?19:-1),i(),s(o.sameYearCount()?20:-1),i(),s(o.directorGenreSpan()?21:-1),i(),s(o.genrePeerCount()?22:-1),i(),s(o.catalogRankByRating()?23:-1),i(),s(o.directorHighRatedCount()?24:-1),i(),s(o.genreLabel()?25:-1),i(),s(o.movieTitleWordCount()?26:-1),i(),s(o.decadeStreamableCount()?27:-1),i(),s(o.primaryGenreStreamablePct()?28:-1),i(),s(o.sameLanguageCount()?29:-1),i(),s(o.directorCareerSpan()?30:-1),i(),s(o.movieGenreCount()?31:-1),i(),s(o.movieImdbLinked()?32:-1),i(),s(o.isPreWar()?33:-1),i(),s(o.decadeImdbLinkedPct()?34:-1),i(),s(o.genrePosterCoveragePct()?35:-1),i(),s(o.directorImdbLinkedPct()?36:-1),i(),s(o.decadeLabel()?37:-1),i(3),w("src",o.safeUrl(),$)("title","Watch "+o.movieTitle()),i(),Y("aria-label",o.isFullscreen()?"Exit fullscreen":"Enter fullscreen")("title",o.isFullscreen()?"Exit fullscreen":"Fullscreen"),i(),s(o.isFullscreen()?42:43),i(8),s(o.isWatched()?51:50),i(2),w("href",h.externalUrl,O),i(),_(" Watch on ",h.label," \u2197 "),i(9),s(o.directorFilms().length>0?62:-1),i(),s((n=o.upNext())?63:-1,n)}}function mt(e,t){if(e&1&&(a(0,"a",66),P(),a(1,"svg",20),b(2,"path",74)(3,"polyline",33)(4,"line",75),r(),l(5," View on IMDb "),r()),e&2){let n=m(2);w("href","https://www.imdb.com/title/"+n.movieImdbId(),O)}}function gt(e,t){if(e&1&&(a(0,"div",73)(1,"h3"),l(2),r(),b(3,"app-movie-grid",76),r()),e&2){let n=m(2);i(2),_("Similar Films You Can Watch (",n.similarFilms().length,")"),i(),w("movies",n.similarFilms())}}function pt(e,t){if(e&1&&(a(0,"div",2)(1,"div",54),P(),a(2,"svg",55),b(3,"rect",56)(4,"line",57)(5,"line",58)(6,"line",59)(7,"line",60)(8,"line",61)(9,"line",62)(10,"line",63),r()(),A(),a(11,"h2"),l(12,"Not Available for Free Streaming"),r(),a(13,"p",64)(14,"strong"),l(15),r(),l(16," is likely still under copyright protection and hasn't been released to the public domain. Only films whose copyrights have expired or were never properly renewed can be freely streamed. "),r(),a(17,"div",65),d(18,mt,6,1,"a",66),a(19,"a",66),P(),a(20,"svg",20),b(21,"circle",67)(22,"line",68),r(),l(23," Search Internet Archive "),r(),A(),a(24,"a",69),P(),a(25,"svg",20),b(26,"polyline",70),r(),l(27," Back to Film Details "),r()(),A(),a(28,"div",71)(29,"h3"),l(30,"About Public Domain Films"),r(),a(31,"p"),l(32," Films enter the public domain when their copyright expires. In the US, works published before 1928 are automatically in the public domain. Many later films also entered the public domain due to failure to renew copyright registrations. The Internet Archive hosts over 30,000 freely viewable films. "),r(),a(33,"a",72),l(34,"Learn more \u2192"),r()(),d(35,gt,4,2,"div",73),r()),e&2){let n=m();i(15),S(n.movieTitle()),i(3),s(n.movieImdbId()?18:-1),i(),w("href","https://archive.org/search?query="+n.encodedTitle(),O),i(5),w("routerLink",I(5,H,n.id())),i(11),s(n.similarFilms().length>0?35:-1)}}var de=class e{id=Z.required();catalogService=W(ie);collectionService=W(ae);streamingService=W(le);sanitizer=W(te);titleService=W(ee);notifications=W(oe);playerContainer;loading=c(!0);movieTitle=c("");movieImdbId=c(null);encodedTitle=c("");source=c(null);safeUrl=c("");isFullscreen=c(!1);isWatched=c(!1);upNext=c(null);upNextReason=c("");similarFilms=c([]);directorFilms=c([]);directorName=c("");watchedAgo=c("");movieGenres=c("");movieRating=c("");movieYear=c("");filmAge=c("");directorTotalFilms=c(0);movieLanguage=c("");decadeLabel=c("");decadeValue=c("");directorFilmRank=c("");isCoDirected=c(!1);isSilentEra=c(!1);isNonEnglish=c(!1);decadeFilmCount=c(0);isHighlyRated=c(!1);genreLabel=c("");directorAvgRating=c("");movieDecadeRank=c("");sameYearCount=c(0);directorGenreSpan=c(0);genrePeerCount=c(0);catalogRankByRating=c(0);directorHighRatedCount=c(0);movieTitleWordCount=c(0);decadeStreamableCount=c(0);primaryGenreStreamablePct=c(0);sameLanguageCount=c(0);directorCareerSpan=c(0);movieGenreCount=c(0);movieImdbLinked=c(!1);isPreWar=c(!1);decadeImdbLinkedPct=c(0);genrePosterCoveragePct=c(0);directorImdbLinkedPct=c(0);fullscreenHandler=()=>{this.isFullscreen.set(!!document.fullscreenElement)};keyHandler=t=>{t.key==="f"&&!t.ctrlKey&&!t.metaKey&&!t.altKey&&!(t.target instanceof HTMLInputElement)&&!(t.target instanceof HTMLTextAreaElement)&&(t.preventDefault(),this.toggleFullscreen())};async ngOnInit(){await this.catalogService.load();let t=this.catalogService.movies().find(n=>n.id===this.id());if(t){this.movieTitle.set(t.title);let n=t.title.split(/\s+/).length;n>=3&&this.movieTitleWordCount.set(n),this.movieImdbId.set(t.imdbId),t.imdbId&&this.movieImdbLinked.set(!0),this.encodedTitle.set(encodeURIComponent(t.title)),t.genres.length>0&&this.movieGenres.set(t.genres.slice(0,3).join(" / ")),t.genres.length>=3&&this.movieGenreCount.set(t.genres.length),t.voteAverage>0&&this.movieRating.set(t.voteAverage.toFixed(1)),this.movieYear.set(String(t.year)),t.language&&t.language!=="English"&&this.movieLanguage.set(t.language);let h=t.language||"English",o=this.catalogService.movies().filter(g=>(g.language||"English")===h&&g.id!==t.id).length;if(o>=10&&this.sameLanguageCount.set(o),t.directors.length>1&&this.isCoDirected.set(!0),t.year<1930&&this.isSilentEra.set(!0),t.year<1940&&t.year>=1930&&this.isPreWar.set(!0),t.language&&t.language!=="English"&&t.language!=="en"&&this.isNonEnglish.set(!0),t.voteAverage>=8&&this.isHighlyRated.set(!0),t.genres.length>0&&this.genreLabel.set(t.genres[0]),t.genres.length>0){let g=this.catalogService.movies().filter(C=>C.genres.includes(t.genres[0])),p=g.filter(C=>C.id!==t.id).length;if(p>=10&&this.genrePeerCount.set(p),g.length>=10){let C=Math.round(g.filter(D=>D.isStreamable).length/g.length*100);C>0&&C<100&&this.primaryGenreStreamablePct.set(C);let E=Math.round(g.filter(D=>D.posterUrl).length/g.length*100);E>0&&E<100&&this.genrePosterCoveragePct.set(E)}}if(t.voteAverage>0){let p=this.catalogService.movies().filter(C=>C.voteAverage>0).sort((C,E)=>E.voteAverage-C.voteAverage).findIndex(C=>C.id===t.id);p>=0&&p<100&&this.catalogRankByRating.set(p+1)}let u=Math.floor(t.year/10)*10;this.decadeLabel.set(`${u}s`),this.decadeValue.set(String(u));let f=this.catalogService.movies().filter(g=>Math.floor(g.year/10)*10===u);f.length>=10&&this.decadeFilmCount.set(f.length);let M=f.filter(g=>g.isStreamable).length;if(M>=5&&this.decadeStreamableCount.set(M),f.length>=10){let g=Math.round(f.filter(p=>p.imdbId).length/f.length*100);g>0&&g<100&&this.decadeImdbLinkedPct.set(g)}let x=this.catalogService.movies().filter(g=>g.year===t.year&&g.id!==t.id).length;x>=5&&this.sameYearCount.set(x);let k=f.filter(g=>g.voteAverage>0).sort((g,p)=>p.voteAverage-g.voteAverage);if(k.length>=10&&t.voteAverage>0){let g=k.findIndex(p=>p.id===t.id);g>=0&&g<10&&this.movieDecadeRank.set(`#${g+1} in ${u}s`)}let N=new Date().getFullYear()-t.year;N>=50&&this.filmAge.set(`${N} years old`),this.titleService.setTitle(`Watch ${t.title} \u2014 BW Cinema`);let T=this.streamingService.getSource(t.internetArchiveId,t.youtubeId);if(this.source.set(T),this.isWatched.set(this.collectionService.isWatched(t.id)),this.isWatched()){let g=this.collectionService.watched().find(p=>p.movieId===t.id);g&&this.watchedAgo.set(this.timeAgo(g.watchedAt))}if(T){this.safeUrl.set(this.sanitizer.bypassSecurityTrustResourceUrl(T.embedUrl)),this.collectionService.trackProgress(t.id);let g=this.findUpNext(t);if(this.upNext.set(g.movie),this.upNextReason.set(g.reason),t.directors.length>0){this.directorName.set(t.directors[0]);let p=this.catalogService.movies().filter(v=>v.id!==t.id&&v.directors.some(y=>t.directors.includes(y)));this.directorTotalFilms.set(p.length+1);let C=[...p,t];if(C.length>=3){let v=C.map(F=>F.year),y=Math.max(...v)-Math.min(...v);y>=5&&this.directorCareerSpan.set(y)}if(p.length>=2){let v=[...p,t].sort((F,ge)=>F.year-ge.year),y=v.findIndex(F=>F.id===t.id);y>=0&&this.directorFilmRank.set(`Film ${y+1} of ${v.length} chronologically`)}let E=[...p,t].filter(v=>v.voteAverage>0);E.length>=2&&this.directorAvgRating.set((E.reduce((v,y)=>v+y.voteAverage,0)/E.length).toFixed(1));let D=[...p,t].filter(v=>v.voteAverage>=7).length;D>=2&&this.directorHighRatedCount.set(D);let G=new Set;for(let v of[...p,t])for(let y of v.genres)G.add(y);G.size>=3&&this.directorGenreSpan.set(G.size);let U=[...p,t];if(U.length>=3){let v=Math.round(U.filter(y=>y.imdbId).length/U.length*100);v>0&&v<100&&this.directorImdbLinkedPct.set(v)}let me=p.filter(v=>v.posterUrl).sort((v,y)=>y.voteAverage-v.voteAverage).slice(0,8);this.directorFilms.set(me)}}else this.similarFilms.set(this.findSimilar(t))}this.loading.set(!1),document.addEventListener("fullscreenchange",this.fullscreenHandler),document.addEventListener("keydown",this.keyHandler)}ngOnDestroy(){document.removeEventListener("fullscreenchange",this.fullscreenHandler),document.removeEventListener("keydown",this.keyHandler),document.fullscreenElement&&document.exitFullscreen().catch(()=>{})}findSimilar(t){let n=new Set(t.genres.map(o=>o.toLowerCase())),h=Math.floor(t.year/10)*10;return this.catalogService.movies().filter(o=>o.id!==t.id&&o.isStreamable).map(o=>{let u=0,f=o.genres.map(M=>M.toLowerCase());for(let M of f)n.has(M)&&(u+=3);return Math.floor(o.year/10)*10===h&&(u+=2),o.voteAverage>=6&&(u+=1),{movie:o,score:u}}).filter(o=>o.score>0).sort((o,u)=>u.score-o.score||u.movie.voteAverage-o.movie.voteAverage).slice(0,6).map(o=>o.movie)}markWatched(){let t=this.id();this.collectionService.isWatched(t)||(this.collectionService.markWatched(t),this.isWatched.set(!0),this.watchedAgo.set("just now"),this.notifications.show(`Marked "${this.movieTitle()}" as watched`,"success"))}findUpNext(t){let n=this.collectionService.watchlistIds(),h=this.collectionService.watchedIds(),o=new Set(t.genres.map(x=>x.toLowerCase())),u=this.catalogService.movies().filter(x=>x.id!==t.id&&x.isStreamable&&!h.has(x.id)&&x.posterUrl).map(x=>{let k=0,N=n.has(x.id);N&&(k+=5);let T=x.genres.filter(p=>o.has(p.toLowerCase()));k+=T.length*2;let g=x.directors.some(p=>t.directors.includes(p));return g&&(k+=3),x.voteAverage>=7&&(k+=1),{movie:x,score:k,inWatchlist:N,sharedGenres:T,sameDirector:g}}).filter(x=>x.score>0).sort((x,k)=>k.score-x.score);if(u.length===0)return{movie:null,reason:""};let f=u[0],M="";return f.inWatchlist?M="From your watchlist":f.sameDirector?M="Same director":f.sharedGenres.length>0&&(M=`Similar: ${f.sharedGenres[0]}`),{movie:f.movie,reason:M}}shareFilm(){let t=`${window.location.origin}/watch/${this.id()}`;navigator.clipboard.writeText(t).then(()=>{this.notifications.show("Watch link copied to clipboard","success")}).catch(()=>{this.notifications.show("Failed to copy link","error")})}timeAgo(t){let n=Date.now()-t,h=Math.floor(n/6e4);if(h<1)return"just now";if(h<60)return`${h}m ago`;let o=Math.floor(h/60);if(o<24)return`${o}h ago`;let u=Math.floor(o/24);if(u===1)return"yesterday";if(u<30)return`${u}d ago`;let f=Math.floor(u/30);return f===1?"1 month ago":`${f} months ago`}toggleFullscreen(){if(!this.playerContainer)return;let t=this.playerContainer.nativeElement;document.fullscreenElement?document.exitFullscreen().catch(()=>{}):t.requestFullscreen().catch(()=>{})}static \u0275fac=function(n){return new(n||e)};static \u0275cmp=j({type:e,selectors:[["app-watch"]],viewQuery:function(n,h){if(n&1&&Q(pe,5),n&2){let o;J(o=X())&&(h.playerContainer=o.first)}},inputs:{id:[1,"id"]},decls:3,vars:1,consts:[["playerContainer",""],[1,"watch","container"],[1,"watch__unavailable","container"],[1,"watch__header"],[1,"watch__back",3,"routerLink"],[1,"watch__header-year"],[1,"watch__genres"],[1,"text-secondary"],[1,"watch__header-rating"],[1,"watch__player"],["allowfullscreen","","sandbox","allow-same-origin allow-scripts allow-popups",3,"src","title"],[1,"watch__fullscreen-btn",3,"click"],["width","22","height","22","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],[1,"watch__shortcuts"],[1,"watch__shortcut"],[1,"watch__actions"],[1,"watch__mark-btn"],[1,"watch__watched-badge"],["target","_blank","rel","noopener",1,"watch__external-link",3,"href"],[1,"watch__share-btn",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["cx","18","cy","5","r","3"],["cx","6","cy","12","r","3"],["cx","18","cy","19","r","3"],["x1","8.59","y1","13.51","x2","15.42","y2","17.49"],["x1","15.41","y1","6.51","x2","8.59","y2","10.49"],[1,"watch__more-director"],[1,"watch__up-next"],[1,"watch__header-director",3,"routerLink"],["points","4 14 10 14 10 20"],["points","20 10 14 10 14 4"],["x1","14","y1","10","x2","21","y2","3"],["x1","3","y1","21","x2","10","y2","14"],["points","15 3 21 3 21 9"],["points","9 21 3 21 3 15"],["x1","21","y1","3","x2","14","y2","10"],[1,"watch__mark-btn",3,"click"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],["points","20 6 9 17 4 12"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round","stroke-linejoin","round"],[1,"watch__watched-ago"],[1,"watch__more-director-title"],[1,"watch__more-director-row"],[1,"watch__director-film",3,"routerLink"],["loading","lazy",3,"src","alt"],[1,"watch__director-film-placeholder"],[1,"watch__director-film-title"],[1,"watch__director-film-year"],[1,"watch__up-next-label"],[1,"watch__up-next-reason"],[1,"watch__up-next-card",3,"routerLink"],[3,"src","alt"],[1,"watch__up-next-info"],[1,"watch__up-next-rating"],[1,"watch__unavail-icon"],["width","48","height","48","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.5","stroke-linecap","round","stroke-linejoin","round"],["x","2","y","2","width","20","height","20","rx","2.18","ry","2.18"],["x1","7","y1","2","x2","7","y2","22"],["x1","17","y1","2","x2","17","y2","22"],["x1","2","y1","12","x2","22","y2","12"],["x1","2","y1","7","x2","7","y2","7"],["x1","2","y1","17","x2","7","y2","17"],["x1","17","y1","7","x2","22","y2","7"],["x1","17","y1","17","x2","22","y2","17"],[1,"watch__unavail-explain"],[1,"watch__fallback-actions"],["target","_blank","rel","noopener",1,"btn-secondary","watch__fallback-btn",3,"href"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],[1,"btn-primary","watch__fallback-btn",3,"routerLink"],["points","15 18 9 12 15 6"],[1,"watch__unavail-info"],["routerLink","/about",1,"watch__learn-more"],[1,"watch__similar"],["d","M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"],["x1","10","y1","14","x2","21","y2","3"],[3,"movies"]],template:function(n,h){if(n&1&&d(0,ue,1,0,"app-loading-spinner")(1,st,64,45,"div",1)(2,pt,36,7,"div",2),n&2){let o;s(h.loading()?0:(o=h.source())?1:2,o)}},dependencies:[ne,ce,re],styles:[".watch[_ngcontent-%COMP%]{padding:var(--space-xl) 0}.watch__header[_ngcontent-%COMP%]{margin-bottom:var(--space-lg)}.watch__genres[_ngcontent-%COMP%]{font-size:.85rem;color:var(--accent-gold);margin:0 0 var(--space-xs)}.watch__header-year[_ngcontent-%COMP%]{font-weight:400;color:var(--text-secondary);font-size:.85em}.watch__header-rating[_ngcontent-%COMP%]{color:var(--accent-gold);font-weight:600}.watch__header-director[_ngcontent-%COMP%]{color:var(--accent-gold);text-decoration:none}.watch__header-director[_ngcontent-%COMP%]:hover{text-decoration:underline}.watch__back[_ngcontent-%COMP%]{display:inline-block;margin-bottom:var(--space-md);font-size:.95rem}.watch__player[_ngcontent-%COMP%]{position:relative;width:100%;max-width:960px;margin:0 auto;aspect-ratio:4 / 3;background-color:#000;border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow-lg)}.watch__player[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;border:none}.watch__fullscreen-btn[_ngcontent-%COMP%]{position:absolute;bottom:12px;right:12px;width:48px;height:48px;min-width:48px;min-height:48px;padding:0;display:flex;align-items:center;justify-content:center;background:#000000b3;border:1px solid rgba(255,255,255,.2);border-radius:var(--radius);color:#fff;cursor:pointer;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);transition:background-color .2s,border-color .2s;z-index:10}.watch__fullscreen-btn[_ngcontent-%COMP%]:hover{background:#000000e6;border-color:var(--accent-gold);color:var(--accent-gold)}:fullscreen[_nghost-%COMP%]   .watch__player[_ngcontent-%COMP%], :fullscreen   [_nghost-%COMP%]   .watch__player[_ngcontent-%COMP%]{max-width:100%;border-radius:0}.watch__actions[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:var(--space-md);margin-top:var(--space-lg);flex-wrap:wrap}.watch__mark-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--space-sm);padding:var(--space-sm) var(--space-xl);background:linear-gradient(135deg,var(--accent-gold) 0%,#c49b2c 100%);color:var(--bg-deep);border:none;border-radius:var(--radius-lg);font-size:.95rem;font-weight:700;cursor:pointer;transition:transform .2s,box-shadow .2s}.watch__mark-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 16px #d4af374d}.watch__watched-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--space-xs);padding:var(--space-sm) var(--space-lg);background:var(--accent-gold-dim);color:var(--accent-gold);border-radius:var(--radius-lg);font-size:.9rem;font-weight:600}.watch__watched-ago[_ngcontent-%COMP%]{font-size:.75rem;font-weight:400;color:var(--text-tertiary);margin-left:4px}.watch__external-link[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-secondary)}.watch__share-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:var(--space-sm) var(--space-md);background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);color:var(--text-secondary);font-size:.85rem;font-weight:600;cursor:pointer;transition:all .2s}.watch__share-btn[_ngcontent-%COMP%]:hover{border-color:var(--accent-gold);color:var(--accent-gold)}.watch__more-director[_ngcontent-%COMP%]{max-width:960px;margin:var(--space-xl) auto 0}.watch__more-director-title[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:var(--space-md);color:var(--text-secondary)}.watch__more-director-row[_ngcontent-%COMP%]{display:flex;gap:var(--space-md);overflow-x:auto;-webkit-overflow-scrolling:touch;padding-bottom:var(--space-xs)}.watch__director-film[_ngcontent-%COMP%]{flex-shrink:0;width:100px;text-decoration:none;color:inherit;text-align:center;transition:transform .2s}.watch__director-film[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.watch__director-film[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100px;aspect-ratio:2 / 3;object-fit:cover;border-radius:var(--radius);margin-bottom:4px}.watch__director-film-placeholder[_ngcontent-%COMP%]{width:100px;aspect-ratio:2 / 3;background:var(--bg-raised);border-radius:var(--radius);display:flex;align-items:center;justify-content:center;font-family:var(--font-heading);color:var(--text-tertiary);font-size:1.2rem;margin-bottom:4px}.watch__director-film-title[_ngcontent-%COMP%]{display:block;font-size:.75rem;font-weight:600;color:var(--text-primary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.watch__director-film-year[_ngcontent-%COMP%]{display:block;font-size:.7rem;color:var(--text-tertiary)}.watch__up-next[_ngcontent-%COMP%]{max-width:500px;margin:var(--space-xl) auto 0}.watch__up-next-label[_ngcontent-%COMP%]{display:block;font-size:.8rem;font-weight:600;text-transform:uppercase;letter-spacing:.08em;color:var(--text-tertiary);margin-bottom:var(--space-sm)}.watch__up-next-reason[_ngcontent-%COMP%]{display:inline-block;font-size:.75rem;color:var(--accent-gold);background:var(--accent-gold-dim);padding:2px 10px;border-radius:8px;margin-bottom:var(--space-xs)}.watch__up-next-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--space-md);padding:var(--space-md);background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);text-decoration:none;color:inherit;transition:border-color .2s,background-color .2s}.watch__up-next-card[_ngcontent-%COMP%]:hover{border-color:var(--accent-gold);background:var(--bg-raised);color:inherit}.watch__up-next-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:48px;height:72px;object-fit:cover;border-radius:var(--radius-sm);aspect-ratio:2 / 3;flex-shrink:0}.watch__up-next-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.watch__up-next-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:.95rem;color:var(--text-primary)}.watch__up-next-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-secondary)}.watch__up-next-rating[_ngcontent-%COMP%]{color:var(--accent-gold)!important;font-weight:600}.watch__unavailable[_ngcontent-%COMP%]{padding:var(--space-2xl) 0;text-align:center}.watch__fallback-actions[_ngcontent-%COMP%]{display:flex;gap:var(--space-md);justify-content:center;flex-wrap:wrap;margin:var(--space-xl) 0}.watch__fallback-btn[_ngcontent-%COMP%]{display:inline-block;padding:var(--space-md) var(--space-xl);border-radius:var(--radius-lg);font-size:.95rem}.watch__unavail-icon[_ngcontent-%COMP%]{color:var(--text-tertiary);margin-bottom:var(--space-lg)}.watch__unavail-explain[_ngcontent-%COMP%]{color:var(--text-secondary);max-width:520px;margin:0 auto var(--space-sm);line-height:1.7}.watch__unavail-explain[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:var(--text-primary)}.watch__fallback-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:var(--space-sm)}.watch__unavail-info[_ngcontent-%COMP%]{max-width:520px;margin:var(--space-2xl) auto 0;padding:var(--space-lg);background:var(--bg-surface);border:1px solid var(--border);border-radius:var(--radius-lg);text-align:left}.watch__unavail-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.95rem;margin:0 0 var(--space-sm);color:var(--text-primary)}.watch__unavail-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:var(--text-secondary);line-height:1.7;margin:0 0 var(--space-sm)}.watch__learn-more[_ngcontent-%COMP%]{font-size:.85rem;font-weight:600;color:var(--accent-gold)}.watch__similar[_ngcontent-%COMP%]{max-width:800px;margin:var(--space-2xl) auto 0;text-align:left}.watch__similar[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;margin-bottom:var(--space-lg)}.watch__shortcuts[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:var(--space-md);margin-top:var(--space-sm)}.watch__shortcut[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-tertiary)}.watch__shortcut[_ngcontent-%COMP%]   kbd[_ngcontent-%COMP%]{display:inline-block;padding:1px 6px;border-radius:4px;background:var(--bg-raised);border:1px solid var(--border);font-family:var(--font-body);font-size:.7rem;font-weight:700;color:var(--text-secondary);margin-right:3px}@media(hover:none){.watch__shortcuts[_ngcontent-%COMP%]{display:none}}"],changeDetection:0})};export{de as WatchComponent};
